<script src="//maps.google.com/maps/api/js?key=AIzaSyCWwWeJK15L9LFKVlBSY2835aanL7iekRM"></script>
<script src="//cdn.rawgit.com/mahnunchik/markerclustererplus/master/dist/markerclusterer.min.js"></script>
<script src='//cdn.rawgit.com/printercu/google-maps-utility-library-v3-read-only/master/infobox/src/infobox_packed.js' type='text/javascript'></script> <!-- only if you need custom infoboxes -->


<h1>Events</h1>

<%= link_to "Create new event", '/events/new' %>

<div style='width: 800px;'>
  <div id="map" style='width: 800px; height: 400px;'>
    <script>
    handler = Gmaps.build('Google');
    handler.buildMap({ provider: {}, internal: {id: 'map'}}, function(){
      markers = handler.addMarkers([
        {
          "lat": 0,
          "lng": 0,
          "picture": {
            "url": "http://people.mozilla.com/~faaborg/files/shiretoko/firefoxIcon/firefox-32.png",
            "width":  32,
            "height": 32
          },
          "infowindow": "hello!"
        }
      ]);
      markers = handler.addMarkers(<%=raw @hash.to_json %>);
      handler.bounds.extendWith(markers);
      handler.fitMapToBounds();


    });
  </script>
  </div>
</div>

<div class='circle-images'>
  <h1>Sort by sport</h1>
  <% Sport.all.each do |sport| %>
    <a class="circle-image" href="/events?sort=<%=sport.id%>">
      <img src="<%=sport.image_url%>" alt="sport.name">
    </a> 
  <% end %>
  <%= link_to 'Reset', '/events' %>
</div>

<% @events.each do |event| %>
  <div class="row" onclick="javascript:location.href='/events/<%=event.id%>'" style="border: 1px solid black;">
    <div class="col-3">
      <img src="<%=event.image_url%>" alt="event Image" style="width:100px;"> 
    </div>
    <div class="col-6 event_information">
      <h1>Title: <%=event.title %></h1>
      <h1>Description: <%=event.description %></h1>
      <h1>Start time: <%=event.beg_time.strftime('%A, %d %b %Y %l:%M %p') %></h1>
      <h1>End time: <%=event.end_time.strftime('%A, %d %b %Y %l:%M %p') %></h1>
      <h1>Maximum number of athletes: <%=event.max_athletes %></h1>
      <h2>Number of athletes attending</h2>
      <ul>
        <li><%= event.users.count%> / <%= event.max_athletes%></li>
      </ul>


      <h1>Sport: <%=event.sport.name %></h1>

      
    </div>
  </div>
<% end %>